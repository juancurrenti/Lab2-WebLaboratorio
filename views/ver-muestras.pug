extends layout

block content
    .container-fluid
        h1 Muestras de la Orden #{id_Orden}

        if success
            .alert.alert-success.alert-dismissible.fade.show(role="alert")
                strong= success
                button.btn-close(type="button" data-bs-dismiss="alert" aria-label="Close")
        if error
            .alert.alert-danger.alert-dismissible.fade.show(role="alert")
                strong Error: 
                | #{error}
                button.btn-close(type="button" data-bs-dismiss="alert" aria-label="Close")

        if muestras && muestras.length > 0
            table.table.table-striped.mt-4
                thead
                    tr
                        th #ID Muestra
                        th Tipo de Muestra
                        th Fecha Recepci√≥n
                        th Estado
                        th Acciones
                tbody
                    each muestra in muestras
                        tr
                            td= muestra.id_Muestra
                            td= muestra.tipoMuestra.tipoDeMuestra
                            td= muestra.Fecha_Recepcion ? new Date(muestra.Fecha_Recepcion).toLocaleDateString('es-AR') : 'No disponible'
                            td= muestra.estado
                            td 

                                - const isPending = muestra.estado === 'pendiente'
                                form(action=`/orden/muestras/imprimir/${muestra.id_Muestra}` method="GET" target="_blank")

                                    button.btn.btn-primary.btn-sm(
                                        type="submit",
                                        disabled=isPending,
                                        title=isPending ? 'La muestra debe ser recibida para poder imprimir la etiqueta' : 'Imprimir etiqueta'
                                    ) Imprimir Etiqueta
            
            a.btn.btn-secondary.mt-4(href="javascript:history.back()") Volver
            
        else
            p.text-muted No hay muestras asociadas a esta orden.
            a.btn.btn-secondary.mt-4(href="javascript:history.back()") Volver